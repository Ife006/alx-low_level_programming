working with more mallocs and free
