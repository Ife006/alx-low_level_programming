working with more mallocs and frees
